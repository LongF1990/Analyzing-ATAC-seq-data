library("edgeR")
x<-read.delim("W82_W05_matrix.txt",row.names="Gene")
group<-factor(c(1,1,1,2,2,2))
y<-DGEList(counts=x,group=group)
y <- calcNormFactors(y,lib.size=c(496786872,516450052,321680044,238358310,390526808,201216098))
design<-model.matrix(~0+group)
y <- estimateGLMCommonDisp(y,design)
y <- estimateGLMTrendedDisp(y,design)
y <- estimateGLMTagwiseDisp(y,design)
fit<-glmFit(y,design)
lrt.2vs1 <- glmLRT(fit, contrast=c(-1,1))
top2v1 <- topTags(lrt.2vs1, n=length(x[,3]))
write.table(top2v1, "W82_W05_matrix_edgeR_output.txt", sep="\t") 